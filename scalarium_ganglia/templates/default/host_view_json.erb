<% reports = [] -%>

<% if node[:scalarium][:instance][:roles].has_key?("lb") -%>
  <% reports << 'haproxy_requests' -%>
<% end -%>
<% if node[:scalarium][:instance][:roles].has_key?("db-master") -%>
  <% reports << 'mysql_query' -%>
<% end -%>
<% if (node[:scalarium][:instance][:roles].has_key?("rails-app") || (node[:scalarium][:instance][:roles].has_key?("php-app") -%>
  <% reports << 'apache' -%>
  <% reports << 'apache_worker' -%>
  <% reports << 'apache_response_time' -%>
<% end -%>
<% if node[:scalarium][:instance][:roles].has_key?("rails-app") -%>
  <% reports << 'passenger_memory_stats' -%>
  <% reports << 'passenger_status' -%>
<% end -%>
<% if node[:scalarium][:instance][:roles].has_key?("web") -%>
  <% reports << 'nginx_status' -%>
<% end -%>

<%= JSON.pretty_generate({:included_reports => reports}) %>
